<div class="card">
  <div class="card-body">
    <div *ngIf="messages?.length === 0">
      <h4>
        Looks like you havenâ€™t chatted with {{currentUserName}} yet.
      </h4>
      <h5>Send your first message!</h5>
    </div>

    <ul style="overflow-y: auto; max-height: 500px;"
    *ngIf="messages?.length" class="list-unstyled chat">
      <li *ngFor="let message of messages">
        <div class="d-flex justify-contnt-between align-items-center p-2"
          [ngClass]="{'flex-row-reverse': message.senderUserName === currentUserName, 'flex-row bg-body-secondary rounded': message.senderUserName !== currentUserName}">

          <span class="chat-img">
            <img class="rounded-circle" [src]="message.senderProfilePictureUrl || './assets/images/default-user-img.png'"
              [alt]="message.senderUserName">
          </span>
          <div class="chat-body mx-2">
              <div class="text-muted">
                <div class="fw-bold d-flex align-items-center"
                  [ngClass]="message.senderUserName === currentUserName ? 'flex-row-reverse ms-1' : 'flex-row me-1'">
                  <i class="fas fa-clock">{{ message.messageSend | timeago }}</i>
                  <span class="mx-1 small" style="color: gray;">{{ message.messageSend | timeago }}</span>
                  <span *ngIf="!message.dateRead && message.senderUserName === currentUserName"
                    class="text-danger mx-1 fw-bold">(unread)</span>
                  <span
                    *ngIf="message.dateRead && message.senderUserName === currentUserName"
                    class="text-success mx-1 small">(read {{ message.dateRead | timeago }})</span>
                </div>
              </div>
            <p class="my-1"
              [ngClass]="{'text-end': message.senderUserName === currentUserName, 'text-start': message.senderUserName !== currentUserName}">
              {{ message.content }}
            </p>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <div class="card-footer">
    <form #messageForm="ngForm" autocomplete="off" (ngSubmit)="sendMessage()">
      <div class="input-group">
        <input placeholder="Send a private message" [(ngModel)]="messageContent" name="messageContent" type="text"
          class="form-control input-sm" required>
        <div class="input-group-append">
          <button [disabled]="!messageForm.valid" class="btn btn-warning mx-2" type="submit">
            <i class="fas fa-paper-plane"></i> Send
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
