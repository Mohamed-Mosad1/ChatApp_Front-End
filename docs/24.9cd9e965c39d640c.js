"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[24],{4024:(C,u,l)=>{l.r(u),l.d(u,{AdminPanelComponent:()=>U});var r=l(6814),m=l(612),e=l(5879),c=l(6223),p=l(7362);function h(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"div",13)(1,"input",14),e.NdJ("change",function(){const a=e.CHM(t).$implicit;return e.KtG(a.checked=!a.checked)}),e.qZA(),e.TgZ(2,"label",15),e._uU(3),e.qZA()()}if(2&n){const t=d.$implicit,o=e.oxw();e.xp6(1),e.Q6J("id",t.name)("value",t.name)("disabled","Admin"===t.name&&"Admin"===o.user.userName)("checked",t.checked),e.xp6(1),e.Q6J("for",t.name),e.xp6(1),e.hij(" ",t.name," ")}}let f=(()=>{class n{constructor(t){this.bsModalRef=t,this.updateSelectedRoles=new e.vpe}updateRoles(){this.updateSelectedRoles.emit(this.roles),this.bsModalRef.hide()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(p.UZ))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-roles-modals"]],inputs:{updateSelectedRoles:"updateSelectedRoles"},standalone:!0,features:[e.jDz],decls:17,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["autocomplete","off",3,"ngSubmit"],["updateRolesForm","ngForm"],["class","form-check",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-times"],["type","button",1,"btn","btn-success",3,"click"],[1,"fas","fa-check"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","value","disabled","checked","change"],[1,"form-check-label",3,"for"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"h4",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return s.bsModalRef.hide()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"form",5,6),e.NdJ("ngSubmit",function(){return s.updateRoles()}),e.YNc(9,h,4,6,"div",7),e.qZA()(),e.TgZ(10,"div",8)(11,"button",9),e.NdJ("click",function(){return s.bsModalRef.hide()}),e._UZ(12,"i",10),e._uU(13," Close "),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){return s.updateRoles()}),e._UZ(15,"i",12),e._uU(16," Update "),e.qZA()()),2&o&&(e.xp6(2),e.hij("Update User: ",s.user.userName,""),e.xp6(7),e.Q6J("ngForOf",s.roles))},dependencies:[r.ez,r.sg,c.u5,c._Y,c.JL,c.F]})}return n})();var b=l(553),g=l(9862);let v=(()=>{class n{constructor(t){this._httpClient=t,this.baseUrl=b.N.baseUrl}getUsersWithRoles(){return this._httpClient.get(this.baseUrl+"Admin/get-users-with-roles")}updateUsersRoles(t,o){return this._httpClient.post(`${this.baseUrl}Admin/update-roles/${t}?roles=${o}`,{})}static#e=this.\u0275fac=function(o){return new(o||n)(e.LFG(g.eN))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function _(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"tr",8)(1,"td",9),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"button",10),e.NdJ("click",function(){const a=e.CHM(t).$implicit,i=e.oxw();return e.KtG(i.openRoleModal(a))}),e._uU(7,"Edit Roles"),e.qZA()()()}if(2&n){const t=d.$implicit;e.xp6(2),e.Oqu(t.userName),e.xp6(2),e.Oqu(t.roles)}}let R=(()=>{class n{constructor(t,o){this._adminService=t,this._modalService=o,this.users=[]}ngOnInit(){this.getUsersWithRoles()}getUsersWithRoles(){this._adminService.getUsersWithRoles().subscribe({next:t=>{t&&(this.users=t)},error:t=>{console.error("Error fetching users with roles:",t)}})}openRoleModal(t){const o={class:"modal-dialog-centered",initialState:{user:t,roles:this.getRolesArray(t)}};this.bsModalRef=this._modalService.show(f,o),this.bsModalRef.content.updateSelectedRoles.subscribe({next:s=>{const a={roles:s.filter(i=>i.checked).map(i=>i.name)};a.roles.length>0&&this._adminService.updateUsersRoles(t.userName,a.roles).subscribe({next:()=>{t.roles=[...a.roles]},error:i=>{console.error("Error updating user roles:",i)}})}})}getRolesArray(t){const o=t.roles,s=[{name:"Admin",value:"Admin",checked:!1},{name:"Moderator",value:"Moderator",checked:!1},{name:"Member",value:"Member",checked:!1}];return s.forEach(a=>{a.checked=o.includes(a.name)}),s}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(v),e.Y36(p.tT))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-admin-management"]],standalone:!0,features:[e.jDz],decls:13,vars:1,consts:[[1,"row"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-bordered"],[1,"table-dark"],[2,"width","30%"],[2,"width","40%"],[1,"table-group-divider"],["class","table",4,"ngFor","ngForOf"],[1,"table"],["scope","row"],["type","button",1,"btn","btn-outline-info",3,"click"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"table",2)(3,"thead",3)(4,"tr")(5,"th",4),e._uU(6,"User Name"),e.qZA(),e.TgZ(7,"th",5),e._uU(8,"Active Roles"),e.qZA(),e.TgZ(9,"th",4),e._uU(10,"Action"),e.qZA()()(),e.TgZ(11,"tbody",6),e.YNc(12,_,8,2,"tr",7),e.qZA()()()()),2&o&&(e.xp6(12),e.Q6J("ngForOf",s.users))},dependencies:[r.ez,r.sg]})}return n})();var Z=l(4007);function A(n,d){1&n&&(e.TgZ(0,"div",5),e._UZ(1,"app-admin-management"),e.qZA())}const T=function(){return["Admin","Moderator"]};let U=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-admin-panel"]],standalone:!0,features:[e.jDz],decls:6,vars:2,consts:[[1,"text-center","mb-3"],[1,"tab-panel"],[1,"member-tabset"],["heading","Users Roles Management"],["class","container",4,"appHasRole"],[1,"container"]],template:function(o,s){1&o&&(e.TgZ(0,"h2",0),e._uU(1,"Admin Panel"),e.qZA(),e.TgZ(2,"div",1)(3,"tabset",2)(4,"tab",3),e.YNc(5,A,2,0,"div",4),e.qZA()()()),2&o&&(e.xp6(5),e.Q6J("appHasRole",e.DdM(1,T)))},dependencies:[r.ez,c.u5,Z.c,m.P4,m.wW,m.AH,R]})}return n})()}}]);