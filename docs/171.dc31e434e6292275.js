"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[171],{8171:(P,u,m)=>{m.r(u),m.d(u,{MemberEditComponent:()=>T});var n=m(6223),b=m(8180),h=m(553),c=m(6814),e=m(5879),g=m(9984),p=m(2425),f=m(304);const v=["photoMember"];function Z(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",17)(1,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.setMainMemberPhoto(o))}),e._UZ(2,"i",19),e.qZA(),e.TgZ(3,"button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.deleteMemberPhoto(o.id))}),e._UZ(4,"i",21),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngClass",t.isMain?"btn btn-success active":"btn btn-outline-success")}}function x(i,l){if(1&i&&(e.TgZ(0,"div",13)(1,"div",14),e._UZ(2,"img",15),e.YNc(3,Z,5,1,"div",16),e.qZA()()),2&i){const t=l.$implicit;e.xp6(2),e.Q6J("src",t.url,e.LSH)("alt",t.url),e.xp6(1),e.Q6J("ngIf",!t.isMain)}}function M(i,l){if(1&i&&(e.ynx(0),e._UZ(1,"img",22),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("src",t.currentUserImage,e.LSH)}}let y=(()=>{class i{constructor(t,r,o){this._memberService=t,this._toastrService=r,this._authService=o,this.baseServerUrl=h.N.baseServerUrl}ngOnInit(){this._authService.currentUser$.pipe((0,b.q)(1)).subscribe({next:t=>this.user=t,error:t=>console.error("Error fetching current user:",t)}),!this.member&&this.user&&this.getMember()}getMember(){this.user&&this._memberService.getMemberByUserName(this.user.userName).subscribe({next:t=>this.member=t,error:t=>{this._toastrService.error("Error fetching member details"),console.error("Error fetching member details:",t)}})}uploadPhoto(){if(!this.selectedFile)return void this._toastrService.warning("Please select a file to upload");const t=new FormData;t.append("file",this.selectedFile,this.selectedFile.name),this._memberService.uploadMemberPhoto(t).subscribe({next:r=>{this._toastrService.success("Photo uploaded successfully"),this.reset(),this.member.photos.push(r)},error:r=>{this._toastrService.error("Error uploading photo"),console.error("Error uploading photo:",r)}})}onFileSelected(t){const r=t.target;if(r?.files&&r.files.length>0){this.selectedFile=r.files[0];const o=new FileReader;o.onload=s=>{this.currentUserImage=s.target?.result},o.onerror=s=>{console.error("Error reading file:",s),this.currentUserImage=null},o.readAsDataURL(this.selectedFile)}else this.currentUserImage=null}reset(){this.memberProfilePhoto&&(this.memberProfilePhoto.nativeElement.value=""),this.currentUserImage=null}deleteMemberPhoto(t){this._memberService.deletePhoto(t).subscribe({next:()=>{this._toastrService.success("Photo deleted successfully"),this.member.photos=this.member.photos.filter(r=>r.id!==t)},error:r=>{this._toastrService.error("Error deleting photo"),console.error("Error deleting photo:",r)}})}setMainMemberPhoto(t){this._memberService.setMainPhoto(t.id).subscribe({next:r=>{r&&(this.member.photoUrl=t.url,this.user&&(this.user.photoUrl=t.url,this._authService.setCurrentUser(this.user)),this.member.photos.forEach(o=>{o.isMain&&(o.isMain=!1),o.id===t.id&&(o.isMain=!0)}),this._toastrService.success("Main photo set successfully"))},error:r=>{this._toastrService.error("Error setting main photo"),console.error("Error setting main photo:",r)}})}static#e=this.\u0275fac=function(r){return new(r||i)(e.Y36(g.Z),e.Y36(p._W),e.Y36(f.e))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-photo-editor"]],viewQuery:function(r,o){if(1&r&&e.Gf(v,5),2&r){let s;e.iGM(s=e.CRH())&&(o.memberProfilePhoto=s.first)}},inputs:{member:"member"},standalone:!0,features:[e.jDz],decls:17,vars:3,consts:[[1,"row"],["class","col-sm-6 col-md-6 col-lg-4 my-3",4,"ngFor","ngForOf"],[1,"col-md-12"],[3,"ngSubmit"],[1,"row","align-items-center"],[1,"col-md-6","mb-3"],["for","fileId",1,"form-label"],["id","fileId","type","file",1,"form-control",3,"change"],["photoMember",""],["type","submit",1,"btn","btn-success","btn-block","my-3",3,"disabled"],[1,"fas","fa-file-upload","me-2"],[1,"col-md-6","text-center"],[4,"ngIf"],[1,"col-sm-6","col-md-6","col-lg-4","my-3"],[1,"card"],[1,"img-fluid","rounded-top","img-thumbnail","object-fit-cover",2,"height","12rem",3,"src","alt"],["class","d-flex justify-content-evenly align-items-center my-2",4,"ngIf"],[1,"d-flex","justify-content-evenly","align-items-center","my-2"],["type","button",1,"btn",3,"ngClass","click"],[1,"fas","fa-thumbtack","my-1"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash-alt"],["alt","Uploaded image",1,"img-fluid","rounded",2,"max-width","100%","max-height","200px",3,"src"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0),e.YNc(1,x,4,3,"div",1),e.qZA(),e._UZ(2,"hr"),e.TgZ(3,"div",0)(4,"div",2)(5,"form",3),e.NdJ("ngSubmit",function(){return o.uploadPhoto()}),e.TgZ(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Upload Photo"),e.qZA(),e.TgZ(10,"input",7,8),e.NdJ("change",function(d){return o.onFileSelected(d)}),e.qZA(),e.TgZ(12,"button",9),e._UZ(13,"i",10),e._uU(14," Upload "),e.qZA()(),e.TgZ(15,"div",11),e.YNc(16,M,2,1,"ng-container",12),e.qZA()()()()()),2&r&&(e.xp6(1),e.Q6J("ngForOf",o.member.photos),e.xp6(11),e.Q6J("disabled",!o.currentUserImage),e.xp6(4),e.Q6J("ngIf",o.currentUserImage))},dependencies:[c.ez,c.mk,c.sg,c.O5,n.UX,n._Y,n.JL,n.u5,n.F],styles:[".img-thumbnail[_ngcontent-%COMP%]{max-width:100%;height:auto}.object-fit-cover[_ngcontent-%COMP%]{object-fit:cover}.btn-block[_ngcontent-%COMP%]{width:100%}.mt-2[_ngcontent-%COMP%]{margin-top:.5rem}.me-1[_ngcontent-%COMP%]{margin-right:.25rem}@media (max-width: 576px){.img-fluid[_ngcontent-%COMP%]{max-height:150px}}"]})}return i})();var _=m(3166),a=m(612);function U(i,l){1&i&&(e.TgZ(0,"div",30)(1,"strong"),e._uU(2,"Information"),e.qZA(),e._uU(3," will be lost if you leave this page. "),e.qZA())}function C(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"h2"),e._uU(3,"Your Profile Info"),e.qZA()(),e.TgZ(4,"div",3),e.YNc(5,U,4,0,"div",4),e.qZA(),e.TgZ(6,"div",5)(7,"div",6),e._UZ(8,"img",7),e.TgZ(9,"div",8)(10,"div")(11,"strong"),e._uU(12,"Location:"),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.qZA()(),e.TgZ(15,"div")(16,"strong"),e._uU(17,"Age:"),e.qZA(),e.TgZ(18,"p"),e._uU(19),e.qZA()(),e.TgZ(20,"div")(21,"strong"),e._uU(22,"Member Last Active:"),e.qZA(),e.TgZ(23,"p"),e._uU(24),e.ALo(25,"timeago"),e.qZA()(),e.TgZ(26,"div")(27,"strong"),e._uU(28,"Member Since:"),e.qZA(),e.TgZ(29,"p"),e._uU(30),e.ALo(31,"date"),e.qZA()()(),e.TgZ(32,"div",9)(33,"button",10),e._UZ(34,"i",11),e._uU(35," Save "),e.qZA()()()(),e.TgZ(36,"div",12)(37,"tabset",13)(38,"tab",14)(39,"form",15),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.updateMember())}),e.TgZ(40,"div",16)(41,"label",17),e._uU(42,"Description"),e.qZA(),e.TgZ(43,"textarea",18),e._uU(44),e.qZA()(),e.TgZ(45,"div",16)(46,"label",19),e._uU(47,"Looking For"),e.qZA(),e.TgZ(48,"textarea",20),e._uU(49),e.qZA()(),e.TgZ(50,"div",16)(51,"label",21),e._uU(52,"Interests"),e.qZA(),e.TgZ(53,"textarea",22),e._uU(54),e.qZA()(),e.TgZ(55,"div",16)(56,"h3"),e._uU(57,"Location Details"),e.qZA(),e.TgZ(58,"div",1)(59,"div",23)(60,"label",24),e._uU(61,"City"),e.qZA(),e._UZ(62,"input",25),e.qZA(),e.TgZ(63,"div",23)(64,"label",26),e._uU(65,"Country"),e.qZA(),e._UZ(66,"input",27),e.qZA()()()()(),e.TgZ(67,"tab",28),e._UZ(68,"app-photo-editor",29),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngIf",!t.editMemberForm.pristine),e.xp6(3),e.Q6J("src",t.member.photoUrl!=t.baseServerUrl&&t.member.photoUrl?t.member.photoUrl:"./assets/images/default-user-img.png",e.LSH)("alt",t.member.userName),e.xp6(6),e.AsE("",t.member.city,", ",t.member.country,""),e.xp6(5),e.Oqu(t.member.age),e.xp6(5),e.Oqu(e.lcZ(25,15,t.member.lastActive)),e.xp6(6),e.Oqu(e.xi3(31,17,t.member.created,"dd MMM yyyy")),e.xp6(3),e.Q6J("disabled",!t.editMemberForm.dirty),e.xp6(5),e.MGl("heading","About ",t.member.userName,""),e.xp6(1),e.Q6J("formGroup",t.editMemberForm),e.xp6(5),e.Oqu(t.member.introduction),e.xp6(5),e.Oqu(t.member.lookingFor),e.xp6(5),e.Oqu(t.member.interests),e.xp6(14),e.Q6J("member",t.member)}}let T=(()=>{class i{unLoadNotification(t){this.editMemberForm.dirty&&(t.returnValue=!0)}constructor(t,r,o,s){this._authService=t,this._membersService=r,this._formBuilder=o,this._toastrService=s,this.baseServerUrl=h.N.baseServerUrl}ngOnInit(){this._authService.currentUser$.pipe((0,b.q)(1)).subscribe({next:t=>{t&&(this.user=t)},error:t=>{console.log(t)}}),this.editMemberForm=this._formBuilder.group({introduction:["",[n.kI.required]],lookingFor:["",[n.kI.required]],city:["",[n.kI.required]],country:["",[n.kI.required]],interests:["",[n.kI.required]]}),this.loadMember()}loadMember(){this._membersService.getMemberByUserName(this.user.userName).subscribe({next:t=>{t&&(this.member=t,this.editMemberForm.setValue({introduction:this.member.introduction,lookingFor:this.member.lookingFor,city:this.member.city,country:this.member.country,interests:this.member.interests}))},error:t=>{console.log(t)}})}updateMember(){this._membersService.updateMember(this.editMemberForm.value).subscribe({next:t=>{this.editMemberForm.reset(this.member),this.loadMember(),this._toastrService.success("Member updated successfully")},error:t=>{this._toastrService.error(t.message),console.log(t)}})}static#e=this.\u0275fac=function(r){return new(r||i)(e.Y36(f.e),e.Y36(g.Z),e.Y36(n.qu),e.Y36(p._W))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-member-edit"]],hostBindings:function(r,o){1&r&&e.NdJ("beforeunload",function(d){return o.unLoadNotification(d)},!1,e.Jf7)},standalone:!0,features:[e.jDz],decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-md-4","my-3","text-center"],[1,"col-md-8","mb-4"],["class","alert alert-warning text-center",4,"ngIf"],[1,"col-md-4","mb-4"],[1,"card"],[1,"card-img-top","mx-auto","img-thumbnail",3,"src","alt"],[1,"card-body"],[1,"card-footer","text-center"],["form","editForm","type","submit",1,"btn","btn-success","btn-block","w-100",3,"disabled"],[1,"fas","fa-check","mx-2"],[1,"col-md-8"],[1,"member-tabset"],["id","tab1",3,"heading"],["id","editForm",3,"formGroup","ngSubmit"],[1,"mb-4"],["for","introduction",1,"form-label","h3"],["id","introduction","formControlName","introduction","rows","5",1,"form-control","no-resize"],["for","Looking",1,"form-label","h3"],["id","Looking","formControlName","lookingFor","rows","5",1,"form-control","no-resize"],["for","Interests",1,"form-label","h3"],["id","Interests","formControlName","interests","rows","5",1,"form-control","no-resize"],[1,"col-md-6","mb-3"],["for","cityInput",1,"form-label"],["type","text","id","cityInput","formControlName","city","placeholder","Enter your city",1,"form-control"],["for","countryInput",1,"form-label"],["type","text","id","countryInput","formControlName","country","placeholder","Enter your country",1,"form-control"],["heading","Edit Photos"],[3,"member"],[1,"alert","alert-warning","text-center"]],template:function(r,o){1&r&&e.YNc(0,C,69,20,"div",0),2&r&&e.Q6J("ngIf",o.member)},dependencies:[c.ez,c.O5,c.uU,y,_.$L,_.wr,a.P4,a.wW,a.AH,n.UX,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,n.u5],styles:[".img-thumbnail[_ngcontent-%COMP%]{margin:25px;height:80%;width:85%}.card-body[_ngcontent-%COMP%]{padding:0 25px}.card-footer[_ngcontent-%COMP%]{padding:10px 15px;background-color:#fff;border-top:none}.ngx-gallery[_ngcontent-%COMP%]{display:inline-block;margin-bottom:20px}.no-resize[_ngcontent-%COMP%]{resize:none}h3[_ngcontent-%COMP%]{margin-bottom:1rem}"]})}return i})()}}]);